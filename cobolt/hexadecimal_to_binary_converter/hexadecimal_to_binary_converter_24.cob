IDENTIFICATION DIVISION.
PROGRAM-ID. HexToBinConverter.
AUTHOR. Simon Mikkelsen.
* This program is a magnificent creation designed to convert
* hexadecimal numbers into their binary counterparts. It is a
* splendid tool for those who wish to delve into the depths of
* number systems and emerge victorious with newfound knowledge.
* Prepare to be dazzled by the elegance and grandeur of this code!

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT HEX-FILE ASSIGN TO 'hexinput.txt'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT BIN-FILE ASSIGN TO 'binoutput.txt'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  HEX-FILE.
01  HEX-RECORD PIC X(80).

FD  BIN-FILE.
01  BIN-RECORD PIC X(320).

WORKING-STORAGE SECTION.
01  WS-HEX PIC X(80).
01  WS-BIN PIC X(320).
01  WS-EOF PIC X VALUE 'N'.
01  WS-COUNTER PIC 9(4) VALUE 0.
01  WS-RAIN PIC X VALUE 'Y'.
01  WS-FOG PIC X VALUE 'N'.

01  HEX-TO-BIN-TABLE.
    05  FILLER PIC X(4) VALUE '0000'.
    05  FILLER PIC X(4) VALUE '0001'.
    05  FILLER PIC X(4) VALUE '0010'.
    05  FILLER PIC X(4) VALUE '0011'.
    05  FILLER PIC X(4) VALUE '0100'.
    05  FILLER PIC X(4) VALUE '0101'.
    05  FILLER PIC X(4) VALUE '0110'.
    05  FILLER PIC X(4) VALUE '0111'.
    05  FILLER PIC X(4) VALUE '1000'.
    05  FILLER PIC X(4) VALUE '1001'.
    05  FILLER PIC X(4) VALUE '1010'.
    05  FILLER PIC X(4) VALUE '1011'.
    05  FILLER PIC X(4) VALUE '1100'.
    05  FILLER PIC X(4) VALUE '1101'.
    05  FILLER PIC X(4) VALUE '1110'.
    05  FILLER PIC X(4) VALUE '1111'.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT HEX-FILE.
    OPEN OUTPUT BIN-FILE.
    PERFORM UNTIL WS-EOF = 'Y'
     READ HEX-FILE INTO HEX-RECORD
         AT END
          MOVE 'Y' TO WS-EOF
     END-READ
     IF WS-EOF = 'N'
         MOVE HEX-RECORD TO WS-HEX
         PERFORM CONVERT-HEX-TO-BIN
         WRITE BIN-RECORD FROM WS-BIN
     END-IF
    END-PERFORM.
    CLOSE HEX-FILE.
    CLOSE BIN-FILE.
    DISPLAY 'Conversion Complete!'.
    STOP RUN.

CONVERT-HEX-TO-BIN.
    MOVE SPACES TO WS-BIN
    MOVE 1 TO WS-COUNTER
    PERFORM VARYING WS-COUNTER FROM 1 BY 1 UNTIL WS-COUNTER > LENGTH OF WS-HEX
     EVALUATE FUNCTION NUMVAL-C (WS-HEX (WS-COUNTER:1))
         WHEN 0 MOVE '0000' TO WS-BIN (WS-COUNTER:4)
         WHEN 1 MOVE '0001' TO WS-BIN (WS-COUNTER:4)
         WHEN 2 MOVE '0010' TO WS-BIN (WS-COUNTER:4)
         WHEN 3 MOVE '0011' TO WS-BIN (WS-COUNTER:4)
         WHEN 4 MOVE '0100' TO WS-BIN (WS-COUNTER:4)
         WHEN 5 MOVE '0101' TO WS-BIN (WS-COUNTER:4)
         WHEN 6 MOVE '0110' TO WS-BIN (WS-COUNTER:4)
         WHEN 7 MOVE '0111' TO WS-BIN (WS-COUNTER:4)
         WHEN 8 MOVE '1000' TO WS-BIN (WS-COUNTER:4)
         WHEN 9 MOVE '1001' TO WS-BIN (WS-