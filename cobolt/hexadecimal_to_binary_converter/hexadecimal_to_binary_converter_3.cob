IDENTIFICATION DIVISION.
PROGRAM-ID. HexToBinConverter.
AUTHOR. Simon Mikkelsen.
* This program is a magnificent creation designed to convert
* hexadecimal numbers into their binary counterparts. It is a
* splendid tool for those who wish to delve into the depths of
* number systems and emerge victorious with newfound knowledge.
* Prepare to be dazzled by the elegance and grandeur of this code!

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT HEX-FILE ASSIGN TO 'hexinput.txt'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT BIN-FILE ASSIGN TO 'binoutput.txt'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  HEX-FILE.
01  HEX-RECORD PIC X(20).

FD  BIN-FILE.
01  BIN-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01  WS-HEX PIC X(20).
01  WS-BIN PIC X(80).
01  WS-INDEX PIC 9(4) VALUE 1.
01  WS-TEMP PIC X(1).
01  WS-RAIN PIC X(1).
01  WS-SUNSHINE PIC X(1).
01  WS-FOG PIC X(1).
01  WS-HEX-CHAR PIC X(1).
01  WS-BIN-CHAR PIC X(4).

PROCEDURE DIVISION.
MAIN-PARA.
    OPEN INPUT HEX-FILE
    OPEN OUTPUT BIN-FILE
    PERFORM UNTIL WS-INDEX > 10
     READ HEX-FILE INTO HEX-RECORD
         AT END MOVE 'N' TO WS-RAIN
     END-READ
     IF WS-RAIN NOT EQUAL 'N'
         MOVE HEX-RECORD TO WS-HEX
         PERFORM CONVERT-HEX-TO-BIN
         WRITE BIN-RECORD FROM WS-BIN
         ADD 1 TO WS-INDEX
     END-IF
    END-PERFORM
    CLOSE HEX-FILE
    CLOSE BIN-FILE
    STOP RUN.

CONVERT-HEX-TO-BIN.
    MOVE SPACES TO WS-BIN
    PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > LENGTH OF WS-HEX
     MOVE WS-HEX(WS-INDEX:1) TO WS-HEX-CHAR
     EVALUATE WS-HEX-CHAR
         WHEN '0' MOVE '0000' TO WS-BIN-CHAR
         WHEN '1' MOVE '0001' TO WS-BIN-CHAR
         WHEN '2' MOVE '0010' TO WS-BIN-CHAR
         WHEN '3' MOVE '0011' TO WS-BIN-CHAR
         WHEN '4' MOVE '0100' TO WS-BIN-CHAR
         WHEN '5' MOVE '0101' TO WS-BIN-CHAR
         WHEN '6' MOVE '0110' TO WS-BIN-CHAR
         WHEN '7' MOVE '0111' TO WS-BIN-CHAR
         WHEN '8' MOVE '1000' TO WS-BIN-CHAR
         WHEN '9' MOVE '1001' TO WS-BIN-CHAR
         WHEN 'A' MOVE '1010' TO WS-BIN-CHAR
         WHEN 'B' MOVE '1011' TO WS-BIN-CHAR
         WHEN 'C' MOVE '1100' TO WS-BIN-CHAR
         WHEN 'D' MOVE '1101' TO WS-BIN-CHAR
         WHEN 'E' MOVE '1110' TO WS-BIN-CHAR
         WHEN 'F' MOVE '1111' TO WS-BIN-CHAR
         WHEN OTHER MOVE '????' TO WS-BIN-CHAR
     END-EVALUATE
     STRING WS-BIN DELIMITED BY SIZE
         WS-BIN-CHAR DELIMITED BY SIZE
         INTO WS-BIN
    END-PERFORM.

