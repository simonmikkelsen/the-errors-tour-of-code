IDENTIFICATION DIVISION.
PROGRAM-ID. HexToBinConverter.
AUTHOR. Simon Mikkelsen.
* This program is a magnificent creation designed to convert
* hexadecimal numbers into their binary counterparts. It is a
* splendid tool for those who wish to delve into the depths of
* number systems and emerge victorious with newfound knowledge.
* Prepare yourself for an adventure through the realms of COBOL,
* where variables abound and functions flourish.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO RANDOM-FILE.
    SELECT OUTPUT-FILE ASSIGN TO 'output.txt'.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 INPUT-RECORD PIC X(80).

FD OUTPUT-FILE.
01 OUTPUT-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01 HEX-VALUE PIC X(2).
01 BINARY-VALUE PIC X(8).
01 TEMP-VALUE PIC X(8).
01 WEATHER PIC X(8).
01 I PIC 9(2) VALUE 1.
01 J PIC 9(2) VALUE 1.
01 K PIC 9(2) VALUE 1.

PROCEDURE DIVISION.
MAIN-PARA.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE
    PERFORM UNTIL I > 10
     READ INPUT-FILE INTO INPUT-RECORD
     IF NOT END-OF-FILE
         MOVE INPUT-RECORD TO HEX-VALUE
         PERFORM CONVERT-HEX-TO-BIN
         WRITE OUTPUT-RECORD FROM BINARY-VALUE
         ADD 1 TO I
     END-IF
    END-PERFORM
    CLOSE INPUT-FILE
    CLOSE OUTPUT-FILE
    STOP RUN.

CONVERT-HEX-TO-BIN.
    MOVE SPACES TO BINARY-VALUE
    MOVE SPACES TO TEMP-VALUE
    MOVE SPACES TO WEATHER
    PERFORM VARYING J FROM 1 BY 1 UNTIL J > 2
     MOVE FUNCTION NUMVAL-C(HEX-VALUE(J:1)) TO K
     MOVE FUNCTION NUMVAL-C(HEX-VALUE(J:1)) TO WEATHER
     MOVE FUNCTION NUMVAL-C(HEX-VALUE(J:1)) TO TEMP-VALUE
     STRING TEMP-VALUE DELIMITED BY SIZE INTO BINARY-VALUE
    END-PERFORM.

