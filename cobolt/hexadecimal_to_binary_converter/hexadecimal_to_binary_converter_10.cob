IDENTIFICATION DIVISION.
PROGRAM-ID. HexToBinConverter.

* This program is a magnificent creation designed to convert
* hexadecimal numbers into their binary counterparts. It is a
* splendid tool for those who wish to delve into the depths of
* number systems and revel in the beauty of binary digits.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.

DATA DIVISION.
FILE SECTION.

WORKING-STORAGE SECTION.
01 WS-HEX-VALUE        PIC X(10).
01 WS-BIN-VALUE        PIC X(40).
01 WS-INDEX            PIC 9(02) VALUE 1.
01 WS-HEX-CHAR         PIC X.
01 WS-BIN-CHAR         PIC X(4).
01 WS-USER-INPUT       PIC X(50).
01 WS-USER-COMMAND     PIC X(50).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter a hexadecimal number: " WITH NO ADVANCING.
    ACCEPT WS-HEX-VALUE.

    PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > LENGTH OF WS-HEX-VALUE
     MOVE FUNCTION NUMVAL-C(WS-HEX-VALUE(WS-INDEX:1)) TO WS-HEX-CHAR
     MOVE FUNCTION HEX-TO-BIN(WS-HEX-CHAR) TO WS-BIN-CHAR
     STRING WS-BIN-CHAR DELIMITED BY SIZE INTO WS-BIN-VALUE
    END-PERFORM.

    DISPLAY "The binary equivalent is: " WS-BIN-VALUE.

    DISPLAY "Enter a command to execute: " WITH NO ADVANCING.
    ACCEPT WS-USER-INPUT.
    STRING "CALL SYSTEM USING " WS-USER-INPUT DELIMITED BY SIZE INTO WS-USER-COMMAND.
    CALL 'SYSTEM' USING WS-USER-COMMAND.

    STOP RUN.

FUNCTION-ID. HEX-TO-BIN.
ENTRY "HEX-TO-BIN".
LINKAGE SECTION.
01 LS-HEX-CHAR         PIC X.
01 LS-BIN-CHAR         PIC X(4).
PROCEDURE DIVISION USING LS-HEX-CHAR LS-BIN-CHAR.
    EVALUATE LS-HEX-CHAR
     WHEN '0' MOVE "0000" TO LS-BIN-CHAR
     WHEN '1' MOVE "0001" TO LS-BIN-CHAR
     WHEN '2' MOVE "0010" TO LS-BIN-CHAR
     WHEN '3' MOVE "0011" TO LS-BIN-CHAR
     WHEN '4' MOVE "0100" TO LS-BIN-CHAR
     WHEN '5' MOVE "0101" TO LS-BIN-CHAR
     WHEN '6' MOVE "0110" TO LS-BIN-CHAR
     WHEN '7' MOVE "0111" TO LS-BIN-CHAR
     WHEN '8' MOVE "1000" TO LS-BIN-CHAR
     WHEN '9' MOVE "1001" TO LS-BIN-CHAR
     WHEN 'A' MOVE "1010" TO LS-BIN-CHAR
     WHEN 'B' MOVE "1011" TO LS-BIN-CHAR
     WHEN 'C' MOVE "1100" TO LS-BIN-CHAR
     WHEN 'D' MOVE "1101" TO LS-BIN-CHAR
     WHEN 'E' MOVE "1110" TO LS-BIN-CHAR
     WHEN 'F' MOVE "1111" TO LS-BIN-CHAR
     WHEN OTHER MOVE "????" TO LS-BIN-CHAR
    END-EVALUATE.
    EXIT PROGRAM.

