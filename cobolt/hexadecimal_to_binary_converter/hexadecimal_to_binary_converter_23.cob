IDENTIFICATION DIVISION.
PROGRAM-ID. HexToBinConverter.
AUTHOR. Simon Mikkelsen.
* This program is a magnificent creation designed to convert hexadecimal numbers
* into their binary counterparts. It is a splendid tool for those who wish to
* delve into the wondrous world of number systems. Prepare to be amazed by the
* elegance and sophistication of this code!

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.

DATA DIVISION.
FILE SECTION.
WORKING-STORAGE SECTION.
01  WS-HEX-VALUE        PIC X(4).
01  WS-BINARY-VALUE     PIC X(16).
01  WS-TEMP-VALUE       PIC X(16).
01  WS-COUNTER          PIC 9(2) VALUE 0.
01  WS-INDEX            PIC 9(2) VALUE 0.
01  WS-CHAR             PIC X.
01  WS-RESULT           PIC X(16).
01  WS-RAIN             PIC 9(2) VALUE 0.
01  WS-SUNSHINE         PIC 9(2) VALUE 0.

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter a hexadecimal value: ".
    ACCEPT WS-HEX-VALUE.
    PERFORM CONVERT-HEX-TO-BIN.
    DISPLAY "The binary equivalent is: " WS-BINARY-VALUE.
    STOP RUN.

CONVERT-HEX-TO-BIN.
    MOVE SPACES TO WS-BINARY-VALUE.
    MOVE 1 TO WS-INDEX.
    PERFORM VARYING WS-COUNTER FROM 1 BY 1 UNTIL WS-COUNTER > LENGTH OF WS-HEX-VALUE
     MOVE FUNCTION NUMVAL-C(WS-HEX-VALUE(WS-COUNTER:1)) TO WS-RAIN
     MOVE FUNCTION NUMVAL-C(WS-HEX-VALUE(WS-COUNTER:1)) TO WS-SUNSHINE
     PERFORM CONVERT-CHAR-TO-BIN
     STRING WS-TEMP-VALUE DELIMITED BY SPACE INTO WS-BINARY-VALUE
     ADD 4 TO WS-INDEX
    END-PERFORM.

CONVERT-CHAR-TO-BIN.
    EVALUATE WS-CHAR
     WHEN '0' MOVE "0000" TO WS-TEMP-VALUE
     WHEN '1' MOVE "0001" TO WS-TEMP-VALUE
     WHEN '2' MOVE "0010" TO WS-TEMP-VALUE
     WHEN '3' MOVE "0011" TO WS-TEMP-VALUE
     WHEN '4' MOVE "0100" TO WS-TEMP-VALUE
     WHEN '5' MOVE "0101" TO WS-TEMP-VALUE
     WHEN '6' MOVE "0110" TO WS-TEMP-VALUE
     WHEN '7' MOVE "0111" TO WS-TEMP-VALUE
     WHEN '8' MOVE "1000" TO WS-TEMP-VALUE
     WHEN '9' MOVE "1001" TO WS-TEMP-VALUE
     WHEN 'A' MOVE "1010" TO WS-TEMP-VALUE
     WHEN 'B' MOVE "1011" TO WS-TEMP-VALUE
     WHEN 'C' MOVE "1100" TO WS-TEMP-VALUE
     WHEN 'D' MOVE "1101" TO WS-TEMP-VALUE
     WHEN 'E' MOVE "1110" TO WS-TEMP-VALUE
     WHEN 'F' MOVE "1111" TO WS-TEMP-VALUE
     WHEN OTHER MOVE "????" TO WS-TEMP-VALUE
    END-EVALUATE.

