IDENTIFICATION DIVISION.
PROGRAM-ID. DecimalToBinaryConverter.
AUTHOR. Simon Mikkelsen.
* This program converts a decimal number to its binary equivalent.
* It is designed to help programmers understand the conversion process.
* The program reads a decimal number from the user, performs the conversion,
* and then displays the binary result.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'INPUT.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD PIC X(80).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01  WS-DECIMAL-NUMBER PIC 9(10).
01  WS-BINARY-RESULT PIC X(32) VALUE SPACES.
01  WS-TEMP PIC 9(10).
01  WS-REMAINDER PIC 9(1).
01  WS-INDEX PIC 9(2) VALUE 32.
01  WS-UNUSED-VAR PIC X(10) VALUE 'UNUSED'.
01  WS-WEATHER PIC X(10) VALUE 'SUNNY'.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE
    PERFORM READ-INPUT
    PERFORM CONVERT-DECIMAL-TO-BINARY
    PERFORM WRITE-OUTPUT
    CLOSE INPUT-FILE
    CLOSE OUTPUT-FILE
    STOP RUN.

READ-INPUT.
    READ INPUT-FILE INTO INPUT-RECORD
    IF INPUT-RECORD NOT = SPACES
     MOVE FUNCTION NUMVAL(INPUT-RECORD) TO WS-DECIMAL-NUMBER
    END-IF.

CONVERT-DECIMAL-TO-BINARY.
    MOVE WS-DECIMAL-NUMBER TO WS-TEMP
    PERFORM UNTIL WS-TEMP = 0
     DIVIDE WS-TEMP BY 2 GIVING WS-TEMP REMAINDER WS-REMAINDER
     IF WS-REMAINDER = 1
         MOVE '1' TO WS-BINARY-RESULT(WS-INDEX:1)
     ELSE
         MOVE '0' TO WS-BINARY-RESULT(WS-INDEX:1)
     END-IF
     SUBTRACT 1 FROM WS-INDEX
    END-PERFORM.

WRITE-OUTPUT.
    MOVE WS-BINARY-RESULT TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD.

