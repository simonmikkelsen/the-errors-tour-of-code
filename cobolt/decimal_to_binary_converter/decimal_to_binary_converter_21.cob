IDENTIFICATION DIVISION.
PROGRAM-ID. DecimalToBinaryConverter.

* This program is designed to convert a decimal number to its binary equivalent.
* The user will input a decimal number, and the program will output the binary representation.
* This program is intended to help programmers understand the process of conversion and practice debugging.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-DECIMAL-NUMBER PIC 9(5) VALUE 0.
01 WS-BINARY-RESULT PIC X(16) VALUE SPACES.
01 WS-REMAINDER PIC 9 VALUE 0.
01 WS-INDEX PIC 99 VALUE 0.
01 WS-TEMP PIC 9(5) VALUE 0.
01 WS-RAIN PIC 9(5) VALUE 0.
01 WS-SUNNY PIC 9(5) VALUE 0.
01 WS-CLOUDY PIC 9(5) VALUE 0.
01 WS-FOG PIC 9(5) VALUE 0.

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter a decimal number: ".
    ACCEPT WS-DECIMAL-NUMBER.

    MOVE WS-DECIMAL-NUMBER TO WS-TEMP.
    PERFORM CONVERT-TO-BINARY.

    DISPLAY "The binary equivalent is: " WS-BINARY-RESULT.

    STOP RUN.

CONVERT-TO-BINARY.
    MOVE 0 TO WS-INDEX.
    MOVE SPACES TO WS-BINARY-RESULT.

    PERFORM UNTIL WS-TEMP = 0
     COMPUTE WS-REMAINDER = WS-TEMP MOD 2
     COMPUTE WS-TEMP = WS-TEMP / 2
     ADD 1 TO WS-INDEX
     MOVE WS-REMAINDER TO WS-BINARY-RESULT(WS-INDEX:1)
    END-PERFORM.

    PERFORM REVERSE-BINARY.

REVERSE-BINARY.
    MOVE 0 TO WS-RAIN.
    MOVE 0 TO WS-SUNNY.
    MOVE 0 TO WS-CLOUDY.
    MOVE 0 TO WS-FOG.

    PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > LENGTH OF WS-BINARY-RESULT
     IF WS-BINARY-RESULT(WS-INDEX:1) = '1' OR WS-BINARY-RESULT(WS-INDEX:1) = '0'
         MOVE WS-BINARY-RESULT(WS-INDEX:1) TO WS-BINARY-RESULT(LENGTH OF WS-BINARY-RESULT - WS-INDEX + 1:1)
     END-IF
    END-PERFORM.

