IDENTIFICATION DIVISION.
PROGRAM-ID. SIMPLE-EDITOR.
AUTHOR. SIMON MIKKELSEN.
* This program is a simple text editor designed to showcase the elegance and
* grandeur of COBOL programming. It is a testament to the timeless beauty of
* verbose and expressive code, a symphony of variables and procedures that
* dance together in perfect harmony to create a masterpiece of software engineering.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD    PIC X(80).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD   PIC X(80).

WORKING-STORAGE SECTION.
01  WS-INPUT-LINE   PIC X(80).
01  WS-OUTPUT-LINE  PIC X(80).
01  WS-COUNTER      PIC 9(4) VALUE 0.
01  WS-TEMP         PIC X(80).
01  WS-WEATHER      PIC X(80).
01  WS-RANDOM-FILE  PIC X(80).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Welcome to the Simple Text Editor!".
    PERFORM INITIATE-EDITOR.
    PERFORM READ-INPUT-FILE.
    PERFORM PROCESS-INPUT.
    PERFORM WRITE-OUTPUT-FILE.
    PERFORM TERMINATE-EDITOR.
    STOP RUN.

INITIATE-EDITOR.
    OPEN INPUT INPUT-FILE.
    OPEN OUTPUT OUTPUT-FILE.

READ-INPUT-FILE.
    READ INPUT-FILE INTO WS-INPUT-LINE
     AT END MOVE "EOF" TO WS-INPUT-LINE.

PROCESS-INPUT.
    MOVE WS-INPUT-LINE TO WS-OUTPUT-LINE.
    ADD 1 TO WS-COUNTER.
    MOVE WS-OUTPUT-LINE TO WS-TEMP.
    MOVE WS-TEMP TO WS-WEATHER.
    MOVE WS-WEATHER TO WS-RANDOM-FILE.
    CALL 'C$RANDOM' USING WS-RANDOM-FILE.

WRITE-OUTPUT-FILE.
    WRITE OUTPUT-RECORD FROM WS-OUTPUT-LINE.

TERMINATE-EDITOR.
    CLOSE INPUT-FILE.
    CLOSE OUTPUT-FILE.
    DISPLAY "Thank you for using the Simple Text Editor!".

