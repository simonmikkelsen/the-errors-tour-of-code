IDENTIFICATION DIVISION.
PROGRAM-ID. SIMPLE-EDITOR.
AUTHOR. SIMON MIKKELSEN.

* This program is a simple text editor, designed to showcase the
* elegance and versatility of COBOL. It allows users to input text,
* perform basic editing operations, and display the modified text.
* The program is adorned with a plethora of comments to guide the
* reader through its intricate workings, like a maestro conducting
* a symphony of code.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TEXT-LINE PIC X(80).
01 WS-EDITED-TEXT PIC X(80).
01 WS-REGEX-RESULT PIC X(80).
01 WS-REGEX-PATTERN PIC X(80) VALUE '^[A-Z]+$'.
01 WS-REGEX-REPLACEMENT PIC X(80) VALUE 'lowercase'.
01 WS-COUNTER PIC 9(4) VALUE 0.
01 WS-USER-INPUT PIC X(80).
01 WS-OPTION PIC 9.

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Welcome to the Simple Text Editor!".
    DISPLAY "Please enter a line of text:".
    ACCEPT WS-TEXT-LINE.
    PERFORM EDIT-TEXT.
    DISPLAY "Edited text: " WS-EDITED-TEXT.
    STOP RUN.

EDIT-TEXT.
    MOVE WS-TEXT-LINE TO WS-EDITED-TEXT.
    PERFORM VARYING WS-COUNTER FROM 1 BY 1 UNTIL WS-COUNTER > 80
     IF WS-EDITED-TEXT(WS-COUNTER:1) = SPACE
         EXIT PERFORM
     END-IF
     IF FUNCTION NUMVAL(WS-EDITED-TEXT(WS-COUNTER:1)) > 0
         MOVE '0' TO WS-EDITED-TEXT(WS-COUNTER:1)
     END-IF
    END-PERFORM.
    PERFORM APPLY-REGEX.

APPLY-REGEX.
    * This paragraph applies a regular expression to the text.
    * It replaces all uppercase letters with the word 'lowercase'.
    MOVE FUNCTION REVERSE(WS-EDITED-TEXT) TO WS-REGEX-RESULT.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'A' BY 'a'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'B' BY 'b'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'C' BY 'c'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'D' BY 'd'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'E' BY 'e'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'F' BY 'f'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'G' BY 'g'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'H' BY 'h'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'I' BY 'i'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'J' BY 'j'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'K' BY 'k'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'L' BY 'l'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'M' BY 'm'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'N' BY 'n'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'O' BY 'o'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'P' BY 'p'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'Q' BY 'q'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'R' BY 'r'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'S' BY 's'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'T' BY 't'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'U' BY 'u'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'V' BY 'v'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'W' BY 'w'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'X' BY 'x'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'Y' BY 'y'.
    INSPECT WS-REGEX-RESULT REPLACING ALL 'Z' BY 'z'.
    MOVE FUNCTION REVERSE(WS-REGEX-RESULT) TO WS-EDITED-TEXT.

