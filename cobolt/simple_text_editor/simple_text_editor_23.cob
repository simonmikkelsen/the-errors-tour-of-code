IDENTIFICATION DIVISION.
PROGRAM-ID. SIMPLE-EDITOR.
AUTHOR. SIMON MIKKELSEN.
* This program is a simple text editor designed to showcase the
* elegance and grandeur of COBOL programming. It is a testament
* to the timeless beauty of structured programming and the
* meticulous attention to detail that COBOL programmers possess.
* Prepare to embark on a journey through the majestic realms of
* text manipulation and user interaction.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'INPUT.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD PIC X(80).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01  WS-USER-INPUT PIC X(80).
01  WS-TEMP-VAR PIC X(80).
01  WS-RAINY-DAY PIC X(80).
01  WS-SUNNY-DAY PIC X(80).
01  WS-COUNTER PIC 9(4) VALUE 0.
01  WS-EOF PIC X VALUE 'N'.

PROCEDURE DIVISION.
MAIN-PARA.
    PERFORM INIT-PARA
    PERFORM UNTIL WS-EOF = 'Y'
     PERFORM READ-INPUT
     PERFORM PROCESS-INPUT
     PERFORM WRITE-OUTPUT
    END-PERFORM
    PERFORM TERMINATE-PARA
    STOP RUN.

INIT-PARA.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE
    DISPLAY 'Welcome to the Simple Text Editor!'
    DISPLAY 'Please enter your text below:'
    MOVE 'N' TO WS-EOF.

READ-INPUT.
    ACCEPT WS-USER-INPUT
    IF WS-USER-INPUT = 'EXIT'
     MOVE 'Y' TO WS-EOF
    ELSE
     MOVE WS-USER-INPUT TO INPUT-RECORD
    END-IF.

PROCESS-INPUT.
    MOVE INPUT-RECORD TO WS-TEMP-VAR
    MOVE WS-TEMP-VAR TO WS-RAINY-DAY
    MOVE WS-RAINY-DAY TO WS-SUNNY-DAY
    ADD 1 TO WS-COUNTER.

WRITE-OUTPUT.
    MOVE WS-SUNNY-DAY TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD.

TERMINATE-PARA.
    CLOSE INPUT-FILE
    CLOSE OUTPUT-FILE
    DISPLAY 'Thank you for using the Simple Text Editor!'
    DISPLAY 'Goodbye!'.

