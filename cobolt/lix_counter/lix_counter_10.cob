IDENTIFICATION DIVISION.
PROGRAM-ID. LIXCOUNTER.

* This program is designed to count the number of words in a given text
* and calculate the LIX readability index. The LIX readability index is
* a measure of how difficult a text is to read. It is calculated based
* on the number of words, the number of long words (more than 6 letters),
* and the number of sentences in the text.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'INPUT.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD PIC X(100).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01  WS-TEXT.
    05  WS-LINE OCCURS 100 TIMES.
     10  WS-WORD PIC X(20).
01  WS-WORD-COUNT PIC 9(5) VALUE 0.
01  WS-LONG-WORD-COUNT PIC 9(5) VALUE 0.
01  WS-SENTENCE-COUNT PIC 9(5) VALUE 0.
01  WS-LIX-INDEX PIC 9(5)V9(2).

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE
    PERFORM READ-INPUT-FILE
    PERFORM CALCULATE-LIX
    PERFORM WRITE-OUTPUT-FILE
    CLOSE INPUT-FILE
    CLOSE OUTPUT-FILE
    STOP RUN.

READ-INPUT-FILE.
    PERFORM UNTIL EOF
     READ INPUT-FILE INTO INPUT-RECORD
     AT END
         SET EOF TO TRUE
     NOT AT END
         PERFORM PROCESS-LINE
    END-PERFORM.

PROCESS-LINE.
    UNSTRING INPUT-RECORD DELIMITED BY SPACE INTO WS-LINE
    PERFORM VARYING I FROM 1 BY 1 UNTIL I > 100
     IF WS-LINE(I) NOT EQUAL TO SPACES
         ADD 1 TO WS-WORD-COUNT
         IF LENGTH OF WS-LINE(I) > 6
          ADD 1 TO WS-LONG-WORD-COUNT
         END-IF
         IF WS-LINE(I) CONTAINS '.' OR '!' OR '?'
          ADD 1 TO WS-SENTENCE-COUNT
         END-IF
     END-IF
    END-PERFORM.

CALCULATE-LIX.
    IF WS-SENTENCE-COUNT = 0
     MOVE 1 TO WS-SENTENCE-COUNT
    END-IF
    COMPUTE WS-LIX-INDEX = (WS-WORD-COUNT / WS-SENTENCE-COUNT) + ((WS-LONG-WORD-COUNT * 100) / WS-WORD-COUNT).

WRITE-OUTPUT-FILE.
    MOVE 'LIX Index: ' TO OUTPUT-RECORD
    STRING WS-LIX-INDEX DELIMITED BY SIZE INTO OUTPUT-RECORD WITH POINTER 12
    WRITE OUTPUT-RECORD.

