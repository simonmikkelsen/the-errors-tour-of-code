IDENTIFICATION DIVISION.
PROGRAM-ID. FILEMERGER.
AUTHOR. SIMON MIKKELSEN.

* This program merges the contents of two files into a single output file.
* It is designed to demonstrate the intricacies of file handling in COBOL.
* The program reads from two input files, processes the data, and writes the
* combined output to a new file. It also includes various unnecessary
* variables and functions to illustrate complexity.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE-1 ASSIGN TO 'INPUT1.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT INPUT-FILE-2 ASSIGN TO 'INPUT2.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.TXT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE-1.
01  INPUT-RECORD-1 PIC X(100).

FD  INPUT-FILE-2.
01  INPUT-RECORD-2 PIC X(100).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01  WS-EOF1 PIC X VALUE 'N'.
01  WS-EOF2 PIC X VALUE 'N'.
01  WS-TEMP-RECORD PIC X(100).
01  WS-UNNECESSARY-VAR PIC X(100) VALUE 'UNNECESSARY'.
01  WS-FRODO PIC X(100) VALUE 'FRODO'.
01  WS-SAM PIC X(100) VALUE 'SAM'.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT INPUT-FILE-1
    OPEN INPUT INPUT-FILE-2
    OPEN OUTPUT OUTPUT-FILE

    PERFORM UNTIL WS-EOF1 = 'Y' AND WS-EOF2 = 'Y'
     READ INPUT-FILE-1 INTO INPUT-RECORD-1
         AT END MOVE 'Y' TO WS-EOF1
     END-READ

     READ INPUT-FILE-2 INTO INPUT-RECORD-2
         AT END MOVE 'Y' TO WS-EOF2
     END-READ

     IF WS-EOF1 NOT = 'Y'
         MOVE INPUT-RECORD-1 TO WS-TEMP-RECORD
         WRITE OUTPUT-RECORD FROM WS-TEMP-RECORD
     END-IF

     IF WS-EOF2 NOT = 'Y'
         MOVE INPUT-RECORD-2 TO WS-TEMP-RECORD
         WRITE OUTPUT-RECORD FROM WS-TEMP-RECORD
     END-IF

     * Randomly write internal state to