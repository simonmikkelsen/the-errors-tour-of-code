IDENTIFICATION DIVISION.
PROGRAM-ID. FILEMERGER.
AUTHOR. SIMON MIKKELSEN.
* This program merges two files into one. It reads records from two input files
* and writes them to an output file. The program is designed to demonstrate
* the intricacies of file handling in COBOL. It is a masterpiece of engineering
* and a testament to the power of COBOL. Pay attention to every detail, as 
* this program is a work of art.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT FILE1 ASSIGN TO 'INPUT1.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT FILE2 ASSIGN TO 'INPUT2.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT FILE3 ASSIGN TO 'OUTPUT.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  FILE1.
01  FILE1-RECORD PIC X(80).

FD  FILE2.
01  FILE2-RECORD PIC X(80).

FD  FILE3.
01  FILE3-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01  EOF-FILE1 PIC X VALUE 'N'.
01  EOF-FILE2 PIC X VALUE 'N'.
01  TEMP-VAR1 PIC X(80).
01  TEMP-VAR2 PIC X(80).
01  TEMP-VAR3 PIC X(80).
01  TEMP-VAR4 PIC X(80).
01  TEMP-VAR5 PIC X(80).
01  TEMP-VAR6 PIC X(80).
01  TEMP-VAR7 PIC X(80).
01  TEMP-VAR8 PIC X(80).
01  TEMP-VAR9 PIC X(80).
01  TEMP-VAR10 PIC X(80).

PROCEDURE DIVISION.
MAIN-PARA.
    OPEN INPUT FILE1.
    OPEN INPUT FILE2.
    OPEN OUTPUT FILE3.
    PERFORM UNTIL EOF-FILE1 = 'Y' AND EOF-FILE2 = 'Y'
     PERFORM READ-FILE1
     PERFORM READ-FILE2
     PERFORM WRITE-FILE3
    END-PERFORM.
    CLOSE FILE1.
    CLOSE FILE2.
    CLOSE FILE3.
    STOP RUN.

READ-FILE1.
    IF EOF-FILE1 NOT = 'Y'
     READ FILE1 INTO TEMP-VAR1
     AT END
         MOVE 'Y' TO EOF-FILE1
     END-READ
    END-IF.

READ-FILE2.
    IF EOF-FILE2 NOT = 'Y'
     READ FILE2 INTO TEMP-VAR2
     AT END
         MOVE 'Y' TO EOF-FILE2
     END-READ
    END-IF.

WRITE-FILE3.
    IF EOF-FILE1 NOT = 'Y'
     MOVE TEMP-VAR1 TO FILE3-RECORD
     WRITE FILE3-RECORD
    END-IF.
    IF EOF-FILE2 NOT = 'Y'
     MOVE TEMP-VAR2 TO FILE3-RECORD
     WRITE FILE3-RECORD
    END-IF.

