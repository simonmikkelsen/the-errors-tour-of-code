IDENTIFICATION DIVISION.
PROGRAM-ID. FILEMERGER.
AUTHOR. SIMON MIKKELSEN.
* This program is designed to merge files in a way that is both
* unnecessarily complex and verbose. It reads multiple files,
* processes their contents, and writes the result to an output file.
* The program is written in COBOL, a language known for its verbosity
* and strict structure. The purpose of this program is to demonstrate
* file handling and string manipulation in COBOL.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO RANDOM-FILE.
    SELECT OUTPUT-FILE ASSIGN TO 'MERGED.TXT'.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 INPUT-RECORD PIC X(100).

FD OUTPUT-FILE.
01 OUTPUT-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01 WS-EOF PIC X VALUE 'N'.
01 WS-COUNT PIC 9(4) VALUE 0.
01 WS-TEMP PIC X(100).
01 WS-STRING PIC X(100).
01 WS-LOTR-VAR PIC X(100).

PROCEDURE DIVISION.
MAIN-PARA.
    PERFORM INIT-PARA.
    PERFORM READ-FILES-PARA UNTIL WS-EOF = 'Y'.
    PERFORM WRITE-OUTPUT-PARA.
    PERFORM CLEANUP-PARA.
    STOP RUN.

INIT-PARA.
    OPEN INPUT INPUT-FILE.
    OPEN OUTPUT OUTPUT-FILE.

READ-FILES-PARA.
    READ INPUT-FILE INTO WS-STRING
     AT END
         MOVE 'Y' TO WS-EOF
     NOT AT END
         ADD 1 TO WS-COUNT
         MOVE WS-STRING TO WS-TEMP
         PERFORM PROCESS-RECORD-PARA
    END-READ.

PROCESS-RECORD-PARA.
    MOVE WS-TEMP TO WS-LOTR-VAR.
    STRING WS-LOTR-VAR DELIMITED BY SPACE
        INTO WS-STRING.

WRITE-OUTPUT-PARA.
    MOVE WS-STRING TO OUTPUT-RECORD.
    WRITE OUTPUT-RECORD.

CLEANUP-PARA.
    CLOSE INPUT-FILE.
    CLOSE OUTPUT-FILE.