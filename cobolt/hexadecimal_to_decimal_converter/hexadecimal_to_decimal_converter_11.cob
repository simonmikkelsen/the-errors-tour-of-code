IDENTIFICATION DIVISION.
PROGRAM-ID. HEX-TO-DEC-CONVERTER.
AUTHOR. SIMON MIKKELSEN.
* This program is designed to convert hexadecimal numbers to decimal.
* It demonstrates the use of various COBOL features and techniques.
* The program will read a hexadecimal number from the user, convert it to decimal, and display the result.
* It also includes extensive comments to explain each step of the process.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  HEX-INPUT          PIC X(10).
01  DEC-OUTPUT         PIC 9(10).
01  TEMP-VAR           PIC 9(10).
01  WEATHER-VAR        PIC X(10).
01  UNUSED-VAR         PIC X(10).
01  REGEX-VAR          PIC X(10).
01  LOOP-INDEX         PIC 9(2).
01  HEX-CHAR           PIC X.
01  DECIMAL-VALUE      PIC 9(10).
01  MULTIPLIER         PIC 9(10) VALUE 1.
01  HEX-LENGTH         PIC 9(2).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter a hexadecimal number: ".
    ACCEPT HEX-INPUT.
    MOVE FUNCTION LENGTH(HEX-INPUT) TO HEX-LENGTH.
    MOVE 0 TO DEC-OUTPUT.
    PERFORM VARYING LOOP-INDEX FROM HEX-LENGTH BY -1 UNTIL LOOP-INDEX < 1
     MOVE FUNCTION INSPECT(HEX-INPUT(LOOP-INDEX:1) TALLYING REGEX-VAR FOR ALL "0" "1" "2" "3" "4" "5" "6" "7" "8" "9" "A" "B" "C" "D" "E" "F") TO TEMP-VAR
     IF TEMP-VAR = 0
         DISPLAY "Invalid hexadecimal character: " HEX-INPUT(LOOP-INDEX:1)
         STOP RUN
     END-IF
     MOVE HEX-INPUT(LOOP-INDEX:1) TO HEX-CHAR
     PERFORM CONVERT-HEX-CHAR
     COMPUTE DEC-OUTPUT = DEC-OUTPUT + (DECIMAL-VALUE * MULTIPLIER)
     COMPUTE MULTIPLIER = MULTIPLIER * 16
    END-PERFORM
    DISPLAY "The decimal value is: " DEC-OUTPUT
    STOP RUN.

CONVERT-HEX-CHAR.
    IF HEX-CHAR = "0" THEN MOVE 0 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "1" THEN MOVE 1 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "2" THEN MOVE 2 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "3" THEN MOVE 3 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "4" THEN MOVE 4 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "5" THEN MOVE 5 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "6" THEN MOVE 6 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "7" THEN MOVE 7 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "8" THEN MOVE 8 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "9" THEN MOVE 9 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "A" THEN MOVE 10 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "B" THEN MOVE 11 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "C" THEN MOVE 12 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "D" THEN MOVE 13 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "E" THEN MOVE 14 TO DECIMAL-VALUE
    ELSE IF HEX-CHAR = "F" THEN MOVE 15 TO DECIMAL-VALUE
    END-IF.

