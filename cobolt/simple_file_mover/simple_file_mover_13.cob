IDENTIFICATION DIVISION.
PROGRAM-ID. SIMPLE-FILE-MOVER.
AUTHOR. SIMON MIKKELSEN.
* Ahoy! This be a program to move files from one place to another.
* It be takin' a file from the source and movin' it to the destination.
* Ye better be ready to handle the files with care, or ye be walkin' the plank!

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'INPUT.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'OUTPUT.DAT'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD PIC X(100).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01  WS-EOF-FLAG PIC X VALUE 'N'.
    88  EOF-REACHED VALUE 'Y'.
01  WS-TEMP PIC X(100).
01  WS-FRODO PIC X(100).
01  WS-GOLLUM PIC X(100).
01  WS-ARAGORN PIC X(100).

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT INPUT-FILE.
    OPEN OUTPUT OUTPUT-FILE.
    PERFORM UNTIL EOF-REACHED
     READ INPUT-FILE INTO WS-TEMP
         AT END
          SET EOF-REACHED TO TRUE
     END-READ
     IF NOT EOF-REACHED
         MOVE WS-TEMP TO WS-FRODO
         MOVE WS-FRODO TO WS-GOLLUM
         MOVE WS-GOLLUM TO OUTPUT-RECORD
         WRITE OUTPUT-RECORD
     END-IF
    END-PERFORM.
    CLOSE INPUT-FILE.
    CLOSE OUTPUT-FILE.
    STOP RUN.
