IDENTIFICATION DIVISION.
PROGRAM-ID. SIMPLE-FILE-RENAMER.
AUTHOR. SIMON MIKKELSEN.

* This program renames files. It is a simple utility for
* demonstrating file operations in COBOL. The program takes
* an old file name and a new file name as input and renames
* the file accordingly. It is designed to be overly verbose
* and complex to illustrate various COBOL constructs.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT OLD-FILE ASSIGN TO "oldfile.txt"
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT NEW-FILE ASSIGN TO "newfile.txt"
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  OLD-FILE.
01  OLD-RECORD PIC X(100).

FD  NEW-FILE.
01  NEW-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01  WS-OLD-FILE-NAME PIC X(100) VALUE "oldfile.txt".
01  WS-NEW-FILE-NAME PIC X(100) VALUE "newfile.txt".
01  WS-TEMP-FILE-NAME PIC X(100) VALUE "tempfile.txt".
01  WS-ERROR-CODE PIC 9(4) VALUE 0.
01  WS-LOOP-COUNTER PIC 9(4) VALUE 0.
01  WS-FRODO PIC X(100) VALUE SPACES.
01  WS-SAM PIC X(100) VALUE SPACES.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM INITIALIZE-VARIABLES
    PERFORM OPEN-FILES
    PERFORM RENAME-FILE
    PERFORM CLOSE-FILES
    PERFORM DISPLAY-MESSAGE
    STOP RUN.

INITIALIZE-VARIABLES.
    MOVE "oldfile.txt" TO WS-OLD-FILE-NAME
    MOVE "newfile.txt" TO WS-NEW-FILE-NAME
    MOVE "tempfile.txt" TO WS-TEMP-FILE-NAME
    MOVE 0 TO WS-ERROR-CODE
    MOVE 0 TO WS-LOOP-COUNTER
    MOVE SPACES TO WS-FRODO
    MOVE SPACES TO WS-SAM.

OPEN-FILES.
    OPEN INPUT OLD-FILE
    OPEN OUTPUT NEW-FILE.

RENAME-FILE.
    PERFORM UNTIL WS-LOOP-COUNTER > 10
     READ OLD-FILE INTO WS-FRODO
     IF WS-ERROR-CODE = 0
         WRITE NEW-RECORD FROM WS-FRODO
     END-IF
     ADD 1 TO WS-LOOP-COUNTER
    END-PERFORM.

CLOSE-FILES.
    CLOSE OLD-FILE
    CLOSE NEW-FILE.

DISPLAY-MESSAGE.
    DISPLAY "File renamed successfully."

