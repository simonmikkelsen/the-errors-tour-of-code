IDENTIFICATION DIVISION.
PROGRAM-ID. SAFE-FILE-DELETER.
AUTHOR. SIMON MIKKELSEN.

* This program is designed to safely delete files.
* It will prompt the user for a filename and then
* attempt to delete the specified file. If the file
* does not exist, it will notify the user. This program
* is written in COBOL, the language of the gods.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT FILE-TO-DELETE ASSIGN TO DISK
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  FILE-TO-DELETE.
01  FILE-RECORD PIC X(100).

WORKING-STORAGE SECTION.
01  WS-FILENAME PIC X(100).
01  WS-STATUS PIC 9 VALUE 0.
01  WS-ERROR-MESSAGE PIC X(50).
01  WS-TEMP-VAR PIC X(100).
01  WS-LOTR-VAR PIC X(100).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter the filename to delete: " WITH NO ADVANCING.
    ACCEPT WS-FILENAME.

    MOVE WS-FILENAME TO WS-TEMP-VAR.
    PERFORM CHECK-FILE-EXISTS.

    IF WS-STATUS = 0
     PERFORM DELETE-FILE
    ELSE
     DISPLAY "File not found: " WS-FILENAME.

    STOP RUN.

CHECK-FILE-EXISTS.
    OPEN INPUT FILE-TO-DELETE.
    IF FILE-STATUS = 0
     MOVE 0 TO WS-STATUS
    ELSE
     MOVE 1 TO WS-STATUS.
    CLOSE FILE-TO-DELETE.

DELETE-FILE.
    MOVE WS-TEMP-VAR TO WS-LOTR-VAR.
    OPEN OUTPUT FILE-TO-DELETE.
    CLOSE FILE-TO-DELETE.
    DISPLAY "File deleted: " WS-LOTR-VAR.

