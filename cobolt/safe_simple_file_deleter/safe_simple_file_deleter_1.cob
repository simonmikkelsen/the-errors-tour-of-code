IDENTIFICATION DIVISION.
PROGRAM-ID. SAFE-FILE-DELETER.
AUTHOR. SIMON MIKKELSEN.

* This program is designed to delete a file safely.
* It ensures that the file is deleted only if it exists.
* The program uses various checks and balances to achieve this.
* It is written in a verbose and detailed manner to ensure clarity.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT FILE-TO-DELETE ASSIGN TO "file-to-delete.txt"
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  FILE-TO-DELETE.
01  FILE-RECORD.
    05  FILE-DATA PIC X(100).

WORKING-STORAGE SECTION.
01  WS-FILE-STATUS PIC X(2) VALUE SPACES.
01  WS-DELETE-STATUS PIC X(2) VALUE SPACES.
01  WS-FILE-EXISTS PIC X VALUE 'N'.
01  WS-LOTR-VARIABLE PIC X(10) VALUE SPACES.
01  WS-LOTR-VARIABLE2 PIC X(10) VALUE SPACES.
01  WS-LOTR-VARIABLE3 PIC X(10) VALUE SPACES.
01  WS-LOTR-VARIABLE4 PIC X(10) VALUE SPACES.
01  WS-LOTR-VARIABLE5 PIC X(10) VALUE SPACES.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM CHECK-FILE-EXISTS
    IF WS-FILE-EXISTS = 'Y'
     PERFORM DELETE-FILE
    ELSE
     DISPLAY "File does not exist."
    END-IF
    STOP RUN.

CHECK-FILE-EXISTS.
    OPEN INPUT FILE-TO-DELETE
    IF FILE-STATUS = '00'
     MOVE 'Y' TO WS-FILE-EXISTS
    ELSE
     MOVE 'N' TO WS-FILE-EXISTS
    END-IF
    CLOSE FILE-TO-DELETE.

DELETE-FILE.
    OPEN I-O FILE-TO-DELETE
    DELETE FILE-RECORD
    IF FILE-STATUS = '00'
     MOVE '00' TO WS-DELETE-STATUS
     DISPLAY "File deleted successfully."
    ELSE
     MOVE '99' TO WS-DELETE-STATUS
     DISPLAY "File deletion failed."
    END-IF
    CLOSE FILE-TO-DELETE.

