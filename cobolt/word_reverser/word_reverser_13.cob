IDENTIFICATION DIVISION.
PROGRAM-ID. WORDREVERSER.
AUTHOR. SIMON MIKKELSEN.

* This program reverses the characters in a given word.
* It demonstrates basic string manipulation in COBOL.
* The program uses a global variable to store the word to be reversed.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-WORD PIC X(20) VALUE SPACES.
01 WS-REVERSED-WORD PIC X(20) VALUE SPACES.
01 WS-LENGTH PIC 9(02) VALUE 0.
01 WS-INDEX PIC 9(02) VALUE 0.

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY "Enter a word to reverse: " WITH NO ADVANCING.
    ACCEPT WS-WORD.
    PERFORM REVERSE-WORD.
    DISPLAY "Reversed word: " WS-REVERSED-WORD.
    STOP RUN.

REVERSE-WORD.
    MOVE FUNCTION LENGTH(WS-WORD) TO WS-LENGTH
    MOVE 0 TO WS-INDEX
    PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > WS-LENGTH
     MOVE WS-WORD(WS-LENGTH - WS-INDEX + 1:1) TO WS-REVERSED-WORD(WS-INDEX:1)
    END-PERFORM.

