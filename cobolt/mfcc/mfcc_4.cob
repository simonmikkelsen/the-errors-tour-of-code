IDENTIFICATION DIVISION.
PROGRAM-ID. mfcc.
AUTHOR. Simon Mikkelsen.
* This program is a delightful journey through the world of COBOL.
* It is designed to showcase the beauty and elegance of COBOL programming.
* Along the way, we will encounter various charming variables and functions.
* Each one has a unique role to play in our story.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO 'input.dat'
     ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO 'output.dat'
     ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  INPUT-FILE.
01  INPUT-RECORD PIC X(80).

FD  OUTPUT-FILE.
01  OUTPUT-RECORD PIC X(80).

WORKING-STORAGE SECTION.
01  WS-COUNTER PIC 9(4) VALUE 0.
01  WS-TOTAL PIC 9(4) VALUE 0.
01  WS-LOOP-COUNTER PIC 9(4) VALUE 0.
01  WS-STRING PIC X(80).
01  WS-UNUSED-VAR PIC X(10) VALUE 'Frodo'.
01  WS-ANOTHER-UNUSED-VAR PIC X(10) VALUE 'Gandalf'.
01  WS-TEMP-VAR PIC 9(4) VALUE 0.

PROCEDURE DIVISION.
MAIN-PARA.
    OPEN INPUT INPUT-FILE.
    OPEN OUTPUT OUTPUT-FILE.
    PERFORM READ-INPUT UNTIL WS-COUNTER > 1000.
    CLOSE INPUT-FILE.
    CLOSE OUTPUT-FILE.
    STOP RUN.

READ-INPUT.
    READ INPUT-FILE INTO INPUT-RECORD
     AT END MOVE 1001 TO WS-COUNTER
    NOT AT END
     ADD 1 TO WS-COUNTER
     MOVE INPUT-RECORD TO WS-STRING
     PERFORM PROCESS-RECORD
     PERFORM UNUSED-PARA
    END-READ.

PROCESS-RECORD.
    ADD WS-COUNTER TO WS-TOTAL.
    MOVE WS-STRING TO OUTPUT-RECORD.
    WRITE OUTPUT-RECORD.

UNUSED-PARA.
    ADD 1 TO WS-LOOP-COUNTER.
    IF WS-LOOP-COUNTER > 10
     MOVE 0 TO WS-LOOP-COUNTER
    END-IF.

